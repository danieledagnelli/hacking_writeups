26:        private static List<string> blockedIPes = new List<string>();
53:            // start the log checking and blocking malicious IPes
107:                        if (!blockedIPes.Contains(ip))
119:                                BlockIP(ip);
120:                                EventLog.WriteEntry(String.Format("IP address {0} has been blocked due to {1} failed login attempts.", ip, maxFailedAttempts), EventLogEntryType.Warning);
121:                                WriteToLogFile("IP:" + ip + " Blocked due to 10 failure login attempts");
123:                                blockedIPes.Add(ip);
135:        private void BlockIP(string ip)
140:                INetFwRule firewallRule = (INetFwRule)Activator.CreateInstance(Type.GetTypeFromProgID("HNetCfg.FWRule"));
141:                firewallRule.Name = "Block IP " + ip;
142:                firewallRule.Description = "Block IP address " + ip + " due to failed login attempts";
143:                firewallRule.Protocol = (int)NET_FW_IP_PROTOCOL_.NET_FW_IP_PROTOCOL_ANY;
144:                firewallRule.LocalAddresses = "*";
145:                firewallRule.RemoteAddresses = ip;
146:                firewallRule.Direction = NET_FW_RULE_DIRECTION_.NET_FW_RULE_DIR_IN;
147:                firewallRule.Action = NET_FW_ACTION_.NET_FW_ACTION_BLOCK;
148:                firewallRule.Enabled = true;
149:                fwPolicy2.Rules.Add(firewallRule);
153:                EventLog.WriteEntry(String.Format("Error blocking IP: {0}", ex.Message), EventLogEntryType.Error);
154:                WriteToLogFile(String.Format("Error blocking IP: {0}", ex.Message));
